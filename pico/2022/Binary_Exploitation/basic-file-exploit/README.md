# basic-file-exploit
## Description
- **Tags**:
    - picoCTF 2022
    - Binary Exploitation
- **Author**: Will Hong


The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it!
Connect to the program with netcat:
```
$ nc saturn.picoctf.net 52681
```
The program's source code with the flag redacted can be downloaded [here](https://artifacts.picoctf.net/c/543/program-redacted.c).

## Exploration

The description is a bit misleading; there's no actual file writing happening here. The program does contain the flag (redacted for local copy):
```c
static const char* flag = "picoCTF{REDACTED}";
```

This flag is used in exactly one place, which conveniently outputs it to stdout:
```c
  if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
  }
```

This is contained in `data_read()`, which is naturaly called if the user select option '2' from the main control loop (that we have control over using stdin). The condition is also guarded on a `strtol` on `entry` which is controlled by user input. Inputting a value of `0` should naturally allow the execution to enter this code path, even though conceptually `0` should not be a valid choice for the intended logic of the code.

We can use pwntools to automate this in a Python script to extract the flag:
```
$ ./exploit_program-redacted.py
picoCTF{REDACTED}
```

But also from the server:
```
./exploit_program-redacted.py saturn.picoctf.net 52681
picoCTF{...}
```
