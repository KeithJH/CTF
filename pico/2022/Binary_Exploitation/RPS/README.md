# RPS
## Description
- **Tags**:
    - picoCTF 2022
    - Binary Exploitation
    - gets
- **Author**:
    - Will Hong

Here's a program that plays rock, paper, scissors against you. I hear something good happens if you win 5 times in a row.
Connect to the program with netcat:
```
$ nc saturn.picoctf.net 53865
```
The program's source code with the flag redacted can be downloaded [here](https://artifacts.picoctf.net/c/443/game-redacted.c).

## Exploration

"Something good" is apparently printing the flag:
```c
if (wins >= 5) {
    puts("Congrats, here's the flag!");
    puts(flag);
}
```

Playing the game it appears the computer picks a random hand and decides on the winner based on a call to `strstr()`. First it takes `computer_turn` to index into `loses` to determine what it would lose against (so I guess draws are effectively loses for us). It then attempts to compare this loss value to the `player_turn`.

```c
char* hands[3] = {"rock", "paper", "scissors"};
char* loses[3] = {"paper", "scissors", "rock"};
...
int computer_turn = rand() % 3;
printf("You played: %s\n", player_turn);
printf("The computer played: %s\n", hands[computer_turn]);

if (strstr(player_turn, loses[computer_turn])) {
    puts("You win! Play again?");
    return true;
}
```

Since the computer is playing at random we could just wait to get lucky... or we can notice that the comparison can actual be turned in our favor. We just need to make an input that contains all of the possible values that would cause the computer to lose, or simpler put just contains all of the values 'rock paper scissors' (spaces not necessary).

```
$ ./exploit_game.py
[REDACTED]
```