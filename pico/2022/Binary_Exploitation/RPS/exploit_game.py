#!/usr/bin/env python3
from pwn import *
from sys import argv

def run():
	if len(argv) == 3:
		return remote(argv[1], argv[2])
	else:
		context.binary = "./game.elf"
		return process("./game.elf")

context.log_level = "error"

with run() as p:
	for i in range (4):
		p.recvline_contains(b'program')
		p.sendline(b'1')
		p.sendline(b'rock paper scissors')

	p.recvline_contains(b'program')
	p.sendline(b'1')
	p.sendline(b'rock paper scissors')

	p.recvline_contains(b'flag')
	flag = p.recvline().strip().decode("ascii")

info(f"The flag is: {flag}")
print(flag)
